[TOC]
# Node 学习笔记

## 函数式编程

### 高阶函数

高阶函数可以把函数作为参数，或是将函数作为返回值的函数，例如：

```js
function foo(x) {
    return function () {
        return x
    }
}
```

### 偏函数

通过指定部分参数来产生一个新的定制函数的形式就是偏函数

```js
var isType = function (type) {
    return function (obj) {
        return toString().call(obj) == '[object' + type + ']'
    }
}

var isString = isType('String')
var isFunction = isType('Function')
```

## 异步编程解决方案

**Node带来的最大特性莫过于基于事件驱动的非阻塞I/O模型，这是它的灵魂所在。**
非阻塞I/O可以使CPU与I/O并不相互依赖等待，让资源得到更好的利用。对于网络应用而言，并行带来的想象空间更大，延展而开的是分布式和云。并行使得各个单点之间能够更有效地组织起来，这也是Node在云计算厂商中广受青睐的原因。

![异步I/O调用示意图](http://ohg6w8k1d.bkt.clouddn.com/%E5%BC%82%E6%AD%A5I:O%E8%B0%83%E7%94%A8%E7%A4%BA%E6%84%8F%E5%9B%BE.png)

### 难点1 异常处理

Node在处理一场上形成了一种约定，将异常作为回调函数的第一个实参传回，如果为空值，则表明异步调用没有异常跑出。在我们自行编写的异步方法上，也需要去遵循这样一些原则：

* 原则一：必须执行调用者传入的回调函数
* 原则二：正确传递回异常供调用者判断

### 难点2 函数嵌套过深

### 难点3 阻塞代码

### 难点4 多线程编程

### 难点5 异步转同步

### 主要解决方案如下3种

* 事件发布/订阅模式
* Promise/Deferred模式
* 流程控制库

#### 事件发布/订阅模式

事件发布/订阅模式可以实现一个事件与多个回调函数的关联，这些回调函数又称为事件侦听器。通过`emit()`发布事件后，消息会立即传递给当前事件的所有侦听器执行。侦听器可以很灵活地添加和删除，使得事件和具体处理逻辑之间可以很轻松的关联和解耦。

事件发布/订阅模式自身并无同步和异步调用的问题，但在Node中，`emit()`调用多半是伴随事件循环而异步触发的，所以我们说事件发布/订阅广泛应用于异步编程。
